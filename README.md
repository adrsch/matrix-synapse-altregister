# gregister
A group-centric invite-based registration system for Matrix-Synapse. Designed with minimal dependencies to allow as much flexibility as possible in front end configurations.

## How it works
Invite codes can be generated by group administrators. Each invite code can then be used to register an account which is automatically added as a member of the group.

## Dependencies
- PHP (tested on 7.3), and a web server configured to run it. For example, apache or nginx with php-fpm. You can use the same installation as your Matrix server, but you'll need to make a separate configuration and setup PHP if you haven't already.
    - Make sure the PDO and SQLite drivers are installed and enabled in php.ini: https://www.php.net/manual/en/pdo.installation.php
- An up-and-running Matrix-Synapse homeserver. Tested on 0.99.2-6 (most recent version compatible with older iOS client). If you are using a newer version, please test thoroughly before using it on a live server!
- SQLite. Used by Matrix-Synapse, so it may already be installed.
- Composer, local or global installation: https://getcomposer.org/
    - It is possible to get around using composer. This may be useful to those using shared web hosting with limited capabilities and permissions. To do this, simply include matrix-synapse.php and be careful to ensure your gregister.json is not publically exposed! Hardcore the values in the GRegistrar class if necessary.

## Installing
Note: basic skills in PHP and web development are required. While 
- Configure your web root to be a subdirectory of the gregister directory. For example, a public folder alongside the src folder included in the repo. Do not set your web root to be the gregister directory itself!
- Run `php composer.phar install` from the gregister directory.
- Create a sqlite database for storing invites created by the system. This can go anywhere as long as permissions are set so it can be written by the web server.
- Edit gregister.json
    - Set `"homeserverDomain"` to the domain name your home server is using. This is what is entered when setting the server options for logging into the client. __No trailing slash!__
    - Input into `"invitesDatabase"` the path to your freshly created invites database.
    - Additionally, for `"homeserverDatabase"` fill in the location of your Matrix-Synapse homeserver.db database. To find this, check the configuration file you created when installing Matrix-Synapse.
    - Set the amount of time invites last before expiring in `"expirationTimeSeconds"`. The default value 1209600 is 2 weeks.
- Backup your homeserver.db!

Now, you're all set and ready to get started on a front-end! 
A guide for this is in the works and will be up shortly.
